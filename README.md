<div dir="rtl">


در این سرویس امکان افزایش موجودی کیف پول با استفاده از کد تخفیف(هدیه) فراهم شده است

### طراحی دیتابیس

جزئیات طراحی دیتابیس به صورت زیر است:

![doctoreto-voucher-test_data_model](https://user-images.githubusercontent.com/30364441/115973005-296a9f00-a567-11eb-9777-8015d7a64429.png)
  
جریان داده در سرویس به صورت زیر است:

کد تخفیف در اینجا در عمل به معنای کد هدیه است. 
بدین صورت که : 

۱- کد تخفیف با ورودی های حداکثر میزان استفاده و میزان تخفیف با اندازه ثابت، ساخته می شود. در صورتی که حداکثر میزان استفاده وارد نشود، بی نهایت در نظر گرفته خواهد شد.

۲- کاربر اقدام به افزایش موجودی کیف با استفاده از کد تخفیف می کند. در اینجا ورودی ها شامل مقدار مبلغ واریزی به کیف پول و کد تخفیف است. در صورتی که کد تخفیف وارد نشود تنها مبلغ واریزی از سمت کاربر، در نظر گرفته خواهد شد.

۳- تراکنش مبلغ واریزی مشخص شده در مرحله ۲, ایجاد می گردد. در صورتی که کد تخفیف وارد شده باشد، اطلاعات مربوط به کد تخفیف در کنار آیدی تراکنش برای کاربر مورد نظر ذخیره خواهد شد.

۴- با فرض اینکه پس از مرحله ۳, کاربر وارد درگاه پرداخت بانکی شده است، از سمت بانک، اطلاعات تراکنش به علاوه وضعیت آن به سرویس ارسال می شود. در صورت صحیح بودن تراکنش و تایید شدن آن توسط بانک، تراکنش ایجاد شده در مرحله ۳، تایید و مبلغ مشخص شده به کیف پول کاربر واریز می شود. علاوه بر این در صورتی که کد تخفیف(هدیه) در مرحله ۲ وارد شده باشد، تراکنش دیگری برای کد تخفیف ساخته خواهد شد و واریزی دیگری برای کیف پول ثبت خواهد شد. 

### فرضیه های اصلی

هر کاربر یک بار می تواند از هر کد تخفیف استفاده کند.

کد های تخفیف پس از رسیدن به محدودیتشان قابل استفاده نخواهند بود.

کد تخفیف پس از پرداخت نهایی اعمال خواهد شد.

### مستندات وب سرویس ها

برای مشاهده مستندات وب سرویس ها وارد آدرس زیر شوید:

</div>


```php
http://localhost/api/documentation
``` 

----------
<div dir="rtl">


**نصب**

دستورات زیر را دنبال کنید :

**قدم ۱)**

</div>



```php
composer install
```   
 
<div dir="rtl">

**قدم ۲)**

در صورتی که از Docker استفاده می کنید دستور زیر را وارد کنید

</div>


```php
docker-compose up -d 
chomd 777 /storage -R
```   

<div dir="rtl">
 
**قدم ۳)**

.env.example را به .env تغییر نام دهید.

**توجه کنید این مشخصات با توجه به تنظیمات داکر وارد شده است** 

</div>


<div dir="rtl">

**قدم ۴)**

</div>

```php
php artisan migrate:fresh --seed
```

<div dir="rtl"> 

**قدم ۵)**

برای اجرای تست ها از دستور زیر استفاده کنید

</div>

```php
php artisan test
```

<div dir="rtl"> 

حال می توانید وارد آدرس زیر شده و وب سرویس ها را تست کنید:

</div>


```php
http://localhost/api/documentation
``` 
